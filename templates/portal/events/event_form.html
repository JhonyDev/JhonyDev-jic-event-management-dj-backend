{% extends "include/navigation.html" %}
{% load static %}

{% block content %}
<div class="page">
  <!-- Page header -->
  <div class="page-header d-print-none">
    <div class="container-xl">
      <div class="row g-2 align-items-center">
        <div class="col">
          <!-- Page pre-title -->
          <div class="page-pretitle">
            Events
          </div>
          <h2 class="page-title">
            {% if form.instance.pk %}Edit Event{% else %}Create New Event{% endif %}
          </h2>
        </div>
        <!-- Page title actions -->
        <div class="col-auto ms-auto d-print-none">
          <div class="btn-list">
            <a href="{% url 'portal:event_list' %}" class="btn btn-white">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
                stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <line x1="5" y1="12" x2="19" y2="12" />
                <line x1="5" y1="12" x2="11" y2="18" />
                <line x1="5" y1="12" x2="11" y2="6" />
              </svg>
              Back to Events
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page body -->
  <div class="page-body">
    <div class="container-xl">
      <div class="row row-cards">
        <div class="col-12">
          <form method="post" class="card" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="card-header">
              <h3 class="card-title">Event Details</h3>
            </div>

            <div class="card-body">
              <div class="row">
                <div class="col-lg-8">
                  <!-- Basic Information -->
                  <h4 class="mb-3">Basic Information</h4>

                  <!-- Title Field -->
                  <div class="mb-3">
                    <label class="form-label required">{{ form.title.label }}</label>
                    {{ form.title }}
                    {% if form.title.errors %}
                      <div class="invalid-feedback d-block">
                        {% for error in form.title.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>

                  <!-- Description Field -->
                  <div class="mb-3">
                    <label class="form-label required">{{ form.description.label }}</label>
                    {{ form.description }}
                    {% if form.description.errors %}
                      <div class="invalid-feedback d-block">
                        {% for error in form.description.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                    <small class="form-hint">
                      Provide a detailed description of your event, including what attendees can expect.
                    </small>
                  </div>

                  <h4 class="mb-3 mt-4">Date & Time</h4>

                  <div class="row">
                    <!-- Start Date and Time Field -->
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label class="form-label required">{{ form.date.label }}</label>
                        {{ form.date }}
                        {% if form.date.errors %}
                          <div class="invalid-feedback d-block">
                            {% for error in form.date.errors %}{{ error }}{% endfor %}
                          </div>
                        {% endif %}
                      </div>
                    </div>

                    <!-- End Date and Time Field -->
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label class="form-label">{{ form.end_date.label }}</label>
                        {{ form.end_date }}
                        {% if form.end_date.errors %}
                          <div class="invalid-feedback d-block">
                            {% for error in form.end_date.errors %}{{ error }}{% endfor %}
                          </div>
                        {% endif %}
                        <small class="form-hint">Optional - leave blank for single-day events</small>
                      </div>
                    </div>
                  </div>

                  <h4 class="mb-3 mt-4">Location & Venue</h4>

                  <!-- Location Field -->
                  <div class="mb-3">
                    <label class="form-label required">{{ form.location.label }}</label>
                    {{ form.location }}
                    {% if form.location.errors %}
                      <div class="invalid-feedback d-block">
                        {% for error in form.location.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                    <small class="form-hint">
                      Physical address or virtual meeting URL
                    </small>
                  </div>

                  <!-- Venue Details Field -->
                  <div class="mb-3">
                    <label class="form-label">{{ form.venue_details.label }}</label>
                    {{ form.venue_details }}
                    {% if form.venue_details.errors %}
                      <div class="invalid-feedback d-block">
                        {% for error in form.venue_details.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                    <small class="form-hint">
                      Additional venue information (parking, accessibility, directions, etc.)
                    </small>
                  </div>

                  <h4 class="mb-3 mt-4">Event Settings</h4>

                  <div class="row">
                    <!-- Max Attendees Field -->
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label class="form-label required">{{ form.max_attendees.label }}</label>
                        {{ form.max_attendees }}
                        {% if form.max_attendees.errors %}
                          <div class="invalid-feedback d-block">
                            {% for error in form.max_attendees.errors %}{{ error }}{% endfor %}
                          </div>
                        {% endif %}
                      </div>
                    </div>

                    <!-- Status Field -->
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label class="form-label">{{ form.status.label }}</label>
                        {{ form.status }}
                        {% if form.status.errors %}
                          <div class="invalid-feedback d-block">
                            {% for error in form.status.errors %}{{ error }}{% endfor %}
                          </div>
                        {% endif %}
                        <small class="form-hint">
                          Draft events are not visible to attendees
                        </small>
                      </div>
                    </div>
                  </div>

                  <!-- Event Image Field -->
                  <div class="mb-3">
                    <label class="form-label">{{ form.image.label }}</label>
                    {{ form.image }}
                    {% if form.image.errors %}
                      <div class="invalid-feedback d-block">
                        {% for error in form.image.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                    <small class="form-hint">
                      Upload an image that represents your event (recommended: 1200x630px)
                    </small>
                  </div>
                </div>

                <div class="col-lg-4">
                  <!-- Event Info Card -->
                  <div class="card">
                    <div class="card-body">
                      <div class="d-flex align-items-center mb-3">
                        <div class="me-3">
                          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-lg text-blue" width="24" height="24"
                            viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <circle cx="12" cy="12" r="9" />
                            <polyline points="12 7 12 12 15 15" />
                          </svg>
                        </div>
                        <div>
                          <h4 class="card-title mb-0">Quick Tips</h4>
                        </div>
                      </div>
                      <div class="mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm text-muted me-1" width="24"
                          height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                          stroke-linecap="round" stroke-linejoin="round">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <line x1="9" y1="6" x2="20" y2="6" />
                          <line x1="9" y1="12" x2="20" y2="12" />
                          <line x1="9" y1="18" x2="20" y2="18" />
                          <line x1="5" y1="6" x2="5" y2="6.01" />
                          <line x1="5" y1="12" x2="5" y2="12.01" />
                          <line x1="5" y1="18" x2="5" y2="18.01" />
                        </svg>
                        <small class="text-muted">Use a clear, descriptive title</small>
                      </div>
                      <div class="mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm text-muted me-1" width="24"
                          height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                          stroke-linecap="round" stroke-linejoin="round">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <line x1="9" y1="6" x2="20" y2="6" />
                          <line x1="9" y1="12" x2="20" y2="12" />
                          <line x1="9" y1="18" x2="20" y2="18" />
                          <line x1="5" y1="6" x2="5" y2="6.01" />
                          <line x1="5" y1="12" x2="5" y2="12.01" />
                          <line x1="5" y1="18" x2="5" y2="18.01" />
                        </svg>
                        <small class="text-muted">Include all important details</small>
                      </div>
                      <div class="mb-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-sm text-muted me-1" width="24"
                          height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                          stroke-linecap="round" stroke-linejoin="round">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <line x1="9" y1="6" x2="20" y2="6" />
                          <line x1="9" y1="12" x2="20" y2="12" />
                          <line x1="9" y1="18" x2="20" y2="18" />
                          <line x1="5" y1="6" x2="5" y2="6.01" />
                          <line x1="5" y1="12" x2="5" y2="12.01" />
                          <line x1="5" y1="18" x2="5" y2="18.01" />
                        </svg>
                        <small class="text-muted">Double-check date and time</small>
                      </div>
                    </div>
                  </div>

                  {% if form.instance.pk %}
                  <!-- Event Stats for Edit Mode -->
                  <div class="card mt-3">
                    <div class="card-body">
                      <h4 class="card-title mb-3">Event Status</h4>
                      <div class="mb-2">
                        <small class="text-muted">Created:</small><br>
                        <strong>{{ form.instance.created_at|date:"M d, Y" }}</strong>
                      </div>
                      <div class="mb-2">
                        <small class="text-muted">Last Updated:</small><br>
                        <strong>{{ form.instance.updated_at|date:"M d, Y" }}</strong>
                      </div>
                      <div class="mb-2">
                        <small class="text-muted">Organizer:</small><br>
                        <strong>{{ form.instance.organizer.username }}</strong>
                      </div>
                    </div>
                  </div>
                  {% endif %}
                </div>
              </div>
            </div>

            <div class="card-footer">
              <div class="row align-items-center">
                <div class="col-auto">
                  <a href="{% url 'portal:event_list' %}" class="btn btn-white">
                    Cancel
                  </a>
                </div>
                <div class="col-auto ms-auto">
                  <button type="submit" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-device-floppy"
                      width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                      stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                      <path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" />
                      <circle cx="12" cy="14" r="2" />
                      <polyline points="14 4 14 8 8 8 8 4" />
                    </svg>
                    {% if form.instance.pk %}Save Changes{% else %}Create Event{% endif %}
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}